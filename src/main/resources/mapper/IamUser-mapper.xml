<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="IamUser">

    <!-- Result Map 정의
    <resultMap id="iamUserMap" type="iamUserDTO">
        <id property="username" column="EMP_NO"/>
        <result property="realname" column="EMP_NM"/>
        <result property="password" column="EMP_PWD"/>
        <result property="createdDate" column="TZ_DATE"/>
    </resultMap>-->

    <!-- Result Map 정의 -->
    <resultMap id="iamUserMap" type="iamUserDTO">
        <result property="username" column="ENO"/>
        <result property="realname" column="USR_NM"/>
        <result property="password" column="USR_ECY_PWD"/>
        <result property="teamCode" column="TEM_C"/>
        <result property="teamName" column="TEM_NM"/>
        <result property="deptCode" column="BBR_C"/>
        <result property="deptName" column="BBR_NM"/>
        <result property="positionName" column="PT_C_NM"/>
        <result property="jobDetail" column="DTS_DTL_CONE"/>
        <result property="inlineNumber" column="INLE_NO"/>
        <result property="phoneNo" column="CADR_TPN"/>
    </resultMap>

    <!-- Result Map 정의 -->
    <resultMap id="teamSearchMap" type="teamSearchDTO">
        <result property="username" column="ENO"/>
        <result property="realname" column="USR_NM"/>
        <result property="password" column="USR_ECY_PWD"/>
        <result property="teamCode" column="TEM_C"/>
        <result property="teamName" column="TEM_NM"/>
        <result property="deptCode" column="BBR_C"/>
        <result property="deptName" column="BBR_NM"/>
        <result property="positionName" column="PT_C_NM"/>
        <result property="jobDetail" column="DTS_DTL_CONE"/>
        <result property="inlineNumber" column="INLE_NO"/>
    </resultMap>

    <!-- 특정 사용자 조회 -->
    <select id="findUserByUserNo" parameterType="String" resultMap="iamUserMap">
        SELECT A.USR_NM,
               A.ENO,
               A.BBR_C,
               B.BBR_NM,
               A.USR_ECY_PWD,
               A.TEM_C,
               A.TEM_NM,
               A.PT_C_NM,
               A.DTS_DTL_CONE,
               A.CADR_TPN,
               A.INLE_NO
        FROM OEHR.THURXE_CUSRLI A
                 INNER JOIN OEHR.THURXE_CORGLI B ON A.BBR_C = B.PRLM_OGZ_C_CONE
        WHERE
            A.ENO = #{username}
    </select>

    <!-- 휴대폰 번호 조회 -->
    <select id="findPhoneNo" parameterType="String" resultType="String">
        SELECT A.CADR_TPN 
        FROM OEHR.THURXE_CUSRLI A 
        WHERE A.ENO = #{username}
    </select>

    <!-- 모든 데이터 조회 -->
    <select id="findAll" resultMap="iamUserMap">
        SELECT * FROM OHR.IF_IAM_USER
        ORDER BY FST_ENR_DTM DESC
    </select>

    <!-- 모든 팀 조회 -->
    <select id="findAllTeam" resultMap="teamSearchMap">
        SELECT DISTINCT(A.TEM_C), A.TEM_NM FROM OEHR.THURXE_CUSRLI A
    </select>

    <!-- 모든 사용자 정보 조회 -->
    <select id="findAllMember" resultMap="teamSearchMap">
        SELECT A.USR_NM,
               A.ENO,
               A.BBR_C,
               B.BBR_NM,
               A.TEM_C,
               A.TEM_NM,
               A.PT_C_NM,
               A.DTS_DTL_CONE,
               A.INLE_NO
        FROM OEHR.THURXE_CUSRLI A
        INNER JOIN OEHR.THURXE_CORGLI B ON A.BBR_C = B.PRLM_OGZ_C_CONE
    </select>

    <!-- ID/PW 일치 사용자 조회 -->
    <select id="login" parameterType="iamUserDTO" resultMap="iamUserMap">
        SELECT
        A.ENO,
        A.USR_ECY_PWD
        FROM OEHR.THURXE_CUSRLI A
        WHERE
        A.ENO = #{username} AND
        A.USR_ECY_PWD = #{password}
    </select>

    <!-- ID 일치 사용자 조회 -->
    <select id="findByUserId" parameterType="iamUserDTO" resultMap="iamUserMap">
        SELECT *
        FROM OEHR.THURXE_CUSRLI A
        WHERE
        A.ENO = #{username}
    </select>

    <!-- 특정 사용자 조회 -->
    <select id="findByUserNo" parameterType="String" resultMap="teamSearchMap">
        SELECT A.USR_NM,
               A.ENO,
               A.BBR_C,
               B.BBR_NM,
               A.TEM_C,
               A.TEM_NM,
               A.PT_C_NM,
               A.DTS_DTL_CONE,
               '01064624479'
        --A.INLE_NO
        FROM OEHR.THURXE_CUSRLI A
                 INNER JOIN OEHR.THURXE_CORGLI B ON A.BBR_C = B.PRLM_OGZ_C_CONE
        WHERE
            A.ENO = #{searchValue}
    </select>

</mapper>
