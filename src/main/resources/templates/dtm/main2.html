<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org" layout:decorate="~{common/layout/layout}">

<head>
    <th:block layout:fragment="css">
        <link rel="stylesheet" href="/extensions/aos/aos.css">
        <link rel="stylesheet" href="/extensions/animate/animate.min.css" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.2/main.min.css">
        <style>
            .container {
                max-width: 1000px;
                margin: 0 auto;
                padding: 0 20px;
            }
            .fc-add-button {
                background-color: #87CEFA;
                border: none;
            }
            .fc-add-button:hover {
                background-color: #5F9EA0;
            }
            .page-title {
                font-size: 2.5rem;
                font-weight: 700;
                color: #333;
                text-transform: uppercase;
                letter-spacing: 2px;
                margin-bottom: 30px;
                text-align: center;
                position: relative;
            }
            .page-title::after {
                content: '';
                display: block;
                width: 50px;
                height: 3px;
                background-color: #87CEFA;
                margin: 10px auto;
            }
            .fc-day-today {
                background-color: rgba(135, 206, 250, 0.3) !important;
            }
            .selected-date {
                background-color: rgba(95, 158, 160, 0.5) !important;
            }
        </style>
    </th:block>
</head>

<body>
<div layout:fragment="contents">
    <div class="container">
        <h1 class="page-title">근태신청</h1>

        <div id="calendar"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.10.2/main.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var calendarEl = document.getElementById('calendar');
            var selectedDate = null;
            var selectedDateStr = null;  // 선택된 날짜를 문자열로 저장

            var calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'add'
                },
                customButtons: {
                    add: {
                        text: '+',
                        click: function() {
                            // 선택된 날짜가 있으면 URL 파라미터로 전달
                            var url = '/dtm/DtmRegister';
                            if (selectedDateStr) {
                                url += '?date=' + selectedDateStr;
                            }

                            window.location.href = url;
                        }
                    }
                },
                titleFormat: { year: 'numeric', month: 'long' },
                locale: 'ko',
                buttonText: {
                    today: '오늘'
                },
                firstDay: 0,
                height: 'auto',
                fixedWeekCount: false,
                showNonCurrentDates: true,
                dateClick: function(info) {
                    if (selectedDate) {
                        selectedDate.classList.remove('selected-date');
                    }
                    info.dayEl.classList.add('selected-date');
                    selectedDate = info.dayEl;
                    selectedDateStr = info.dateStr;  // YYYY-MM-DD 형식의 날짜 문자열
                }
            });
            calendar.render();
        });
    </script>
</div>
</body>
</html>